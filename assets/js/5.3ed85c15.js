(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{348:function(v,_,t){v.exports=t.p+"assets/img/StorageHierarchy.af347a03.png"},349:function(v,_,t){v.exports=t.p+"assets/img/OSRead.3c900ac5.png"},362:function(v,_,t){"use strict";t.r(_);var a=t(42),s=Object(a.a)({},(function(){var v=this,_=v.$createElement,a=v._self._c||_;return a("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[a("h1",{attrs:{id:"数据库存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据库存储"}},[v._v("#")]),v._v(" 数据库存储")]),v._v(" "),a("h2",{attrs:{id:"预备知识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预备知识"}},[v._v("#")]),v._v(" 预备知识")]),v._v(" "),a("h3",{attrs:{id:"存储设备金字塔"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存储设备金字塔"}},[v._v("#")]),v._v(" 存储设备金字塔")]),v._v(" "),a("p",[a("img",{attrs:{src:t(348),alt:"存储设备金字塔"}})]),v._v(" "),a("ul",[a("li",[v._v("图中各个存储单元由上往下分别为CPU寄存器、CPU缓存、DRAM(动态随机存取存储器)、SSD(固态硬盘)、HDD(机械硬盘)、Network Storage(网络存储设备)\n"),a("ul",[a("li",[v._v("DRAM(Dynamic Random Access Memory): 动态随机存取存储器，计算机内存就是DRAM")])])]),v._v(" "),a("li",[v._v("途中各个设备的读写速率从上至下，以此下降")]),v._v(" "),a("li",[v._v("Volatile(易失性设备)和Non-Valatile(非易失性设备)存储器器的区别\n"),a("ul",[a("li",[v._v("易失性设备(Volatile Device)\n"),a("ul",[a("li",[v._v("易失性意味着如果让机器断电，则数据会丢失")]),v._v(" "),a("li",[v._v("易失性存储支持具有字节可寻址位置的快速随机访问")]),v._v(" "),a("li",[v._v("在本文中，我们将该存储类称为“内存”。")])])]),v._v(" "),a("li",[v._v("非易失性设备(Non-Volatile Device)\n"),a("ul",[a("li",[v._v("非易失性意味着存储设备不需要连续提供电源用于设备保留它正在存储的数据")]),v._v(" "),a("li",[v._v("传统上，非易失性存储在顺序访问方面更好 (可以一次性读取连续的数据块) 和被指针指向的数据")]),v._v(" "),a("li",[v._v("在本文中，我们将该存储类称为“外存”")])])])])])]),v._v(" "),a("h3",{attrs:{id:"不同存储设备读写时间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不同存储设备读写时间"}},[v._v("#")]),v._v(" 不同存储设备读写时间")]),v._v(" "),a("table",[a("thead",[a("tr",[a("th",[v._v("实际读写时间")]),v._v(" "),a("th",[v._v("设备名称")]),v._v(" "),a("th",[v._v("相对读写时间")])])]),v._v(" "),a("tbody",[a("tr",[a("td",[v._v("0.5 ns")]),v._v(" "),a("td",[v._v("L1 Cache")]),v._v(" "),a("td",[v._v("0.5 sec")])]),v._v(" "),a("tr",[a("td",[v._v("7 ns")]),v._v(" "),a("td",[v._v("L2 Cache Ref")]),v._v(" "),a("td",[v._v("7 sec")])]),v._v(" "),a("tr",[a("td",[v._v("100 ns")]),v._v(" "),a("td",[v._v("DRAM")]),v._v(" "),a("td",[v._v("100 sec")])]),v._v(" "),a("tr",[a("td",[v._v("150,000 ns")]),v._v(" "),a("td",[v._v("SSD")]),v._v(" "),a("td",[v._v("1.7 days")])]),v._v(" "),a("tr",[a("td",[v._v("10,000,000 ns")]),v._v(" "),a("td",[v._v("HDD")]),v._v(" "),a("td",[v._v("16.5 weeks")])]),v._v(" "),a("tr",[a("td",[v._v("~30,000,000 ns")]),v._v(" "),a("td",[v._v("Network Storage")]),v._v(" "),a("td",[v._v("11.4 months")])]),v._v(" "),a("tr",[a("td",[v._v("1,000,000 ns")]),v._v(" "),a("td",[v._v("Tape Archives")]),v._v(" "),a("td",[v._v("31.7 years")])])])]),v._v(" "),a("p",[v._v("上图中，左侧时间为真实机器读写时间，右侧将时间放大1000倍，帮助我们理解不同设备之间读写效率的巨大差异，从图中我们可以分析得出，应该尽量让数据库使用设备金字塔的上层，用来加速数据的读写。")]),v._v(" "),a("h3",{attrs:{id:"读取数据为什么不使用操作系统的读取策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取数据为什么不使用操作系统的读取策略"}},[v._v("#")]),v._v(" 读取数据为什么不使用操作系统的读取策略")]),v._v(" "),a("p",[v._v("首先，我们由下图来回顾操作系统，读取数据的过程")]),v._v(" "),a("p",[a("img",{attrs:{src:t(349),alt:"OS读取数据过程"}})]),v._v(" "),a("p",[v._v("如图所示，首先用户选择读取page1，os从磁盘中读取数据到物理内存，然后选择读取page3，os将数据加载到物理内存后，当用户选择读取page2时，我们应该如何处理？同时，数据库中存储的数据是按照一定"),a("strong",[v._v("顺序存储")]),v._v("了，os的读取方式没用充分利用该特性；导致了，数据读取和写入都很慢。该方法还会遇到更多问题：")]),v._v(" "),a("ul",[a("li",[v._v("不能处理多个线程读取数据时候失败的情况")]),v._v(" "),a("li",[v._v("这个方式可以很好解决数据读取问题，但是无法解决多个线程的数据修改过程")])]),v._v(" "),a("p",[v._v("综上所述，操作系统并不是你的好朋友！")]),v._v(" "),a("h3",{attrs:{id:"数据库设计目标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据库设计目标"}},[v._v("#")]),v._v(" 数据库设计目标")]),v._v(" "),a("p",[v._v("由上文，对不同存储设备的了解，我们可以得出数据库管理系统的设计目标如下:")]),v._v(" "),a("ul",[a("li",[v._v("允许数据库管理系统处理超出系统内存的数据")]),v._v(" "),a("li",[v._v("尽量使用上层设备，提高数据读写的效率")]),v._v(" "),a("li",[v._v("以正确的顺序将脏页刷新到磁盘")]),v._v(" "),a("li",[v._v("针对数据特征(连续性数据)的读存策略")]),v._v(" "),a("li",[v._v("缓冲区更换政策")]),v._v(" "),a("li",[v._v("线程/进程调度")])])])}),[],!1,null,null,null);_.default=s.exports}}]);